{
  "name": "Rain Alert Agent",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 9
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -300,
        -60
      ],
      "id": "4c2b0845-cdd0-4127-a82a-17ad45f050af",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "mode": "expression",
        "numberOutputs": 2,
        "output": "={{ $json.available === true }}"
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        140,
        -60
      ],
      "id": "235c8fb1-58a5-4e28-8791-2068b839afd2",
      "name": "Switch"
    },
    {
      "parameters": {
        "url": "https://api.openweathermap.org/data/2.5/forecast?lat=23.0206&lon=76.8537&appid=YourApiKey&units=metric",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        40
      ],
      "id": "5550bdcb-fe63-4c24-a029-379101f31ee0",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "sendTo": "youremail@gmail.com",
        "subject": "Rain Alert: Bring Your Umbrella!",
        "emailType": "text",
        "message": "=Hi yourname, \n\nRain is expected between 9:00 AM and 12:00 PM today, and you have an event scheduled.  Don’t forget to carry your umbrella ☔  \n\n– Your Rain Alert Agent 🌦️",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1020,
        140
      ],
      "id": "19748713-7a6d-4c46-95c9-2f4ef3a1970c",
      "name": "Send a message",
      "webhookId": "aed1c369-4887-4013-8f2d-0a792a6e5f4f",
      "credentials": {
        "gmailOAuth2": {
          "id": "obKiSQ2c2CDm2NR1",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        360,
        -160
      ],
      "id": "7ecb3052-fbd9-4ac6-9037-a3dd426bbe05",
      "name": "No Operation"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        1020,
        -60
      ],
      "id": "f4da11bc-e5ea-4851-afcd-34b60f2fdf11",
      "name": "No Operation "
    },
    {
      "parameters": {
        "content": "",
        "height": 640,
        "width": 1680,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -400,
        -280
      ],
      "typeVersion": 1,
      "id": "dcbf83ea-8e44-4bb8-b845-c3325efdbdec",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "# Rain Alert Agent\n\nThis Agent is an automated workflow built with n8n that checks the weather forecast daily for your location between 9:30 AM and 12:00 PM, and sends you an email reminder to carry an umbrella if rain is expected. It checks your Google Calendar to notify you only when you have scheduled events during that time.\n\n\n\n\n\n",
        "height": 200,
        "width": 560,
        "color": 5
      },
      "id": "b350be77-7124-4366-8505-2eab77c06252",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -400,
        -280
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "resource": "calendar",
        "calendar": {
          "__rl": true,
          "value": "youremail@gmail.com",
          "mode": "list",
          "cachedResultName": "youremail@gmail.com"
        },
        "timeMin": "={{ $now.set({ hour: 9, minute: 0, second: 0, millisecond: 0 }).toFormat(\"yyyy-LL-dd HH:mm:ss\") }}\n",
        "timeMax": "={{ $now.set({ hour: 12, minute: 0, second: 0, millisecond: 0 }).toFormat(\"yyyy-LL-dd HH:mm:ss\") }}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        -80,
        -60
      ],
      "id": "bee3699b-2702-4caa-9c9f-944cb2842c95",
      "name": "Calendar Availability",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "9r3bcB9Skg9zEYve",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "91098f7e-87bc-4128-adfb-ed401a8f9f98",
              "name": "rainExpected",
              "value": "={{ \n  $json.list.some(\n    item => \n      [\"09:00:00\", \"12:00:00\"].some(time => item.dt_txt.includes(time)) &&\n      item.rain &&\n      item.rain[\"3h\"] > 0\n  ) \n}}\n",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        580,
        40
      ],
      "id": "11633eb0-34f9-4c88-a686-455b0fc9b28e",
      "name": "Set"
    },
    {
      "parameters": {
        "mode": "expression",
        "numberOutputs": 2,
        "output": "={{ $json.rainExpected.trim() === \"true\" }}"
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        800,
        40
      ],
      "id": "4c95499a-f434-4373-a34c-b88dfc8362ec",
      "name": "Switch "
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Calendar Availability",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "No Operation",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Set",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        []
      ]
    },
    "Calendar Availability": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set": {
      "main": [
        [
          {
            "node": "Switch ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch ": {
      "main": [
        [
          {
            "node": "No Operation ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "cbf68aff-e69b-42cc-9502-f15c86d3417e",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "ad8b686e4cce2cb62db91b84349cdff2b13ad2261d3b5fa42cf025d21032b6a0"
  },
  "id": "Y7V7mwepSkXgOvAV",
  "tags": []
}